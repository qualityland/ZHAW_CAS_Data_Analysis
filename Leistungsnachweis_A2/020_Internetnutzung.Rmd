# 2. Internetnutzung in der Schweiz

## Datenbasis

Die bereitgestellte Datei _Internetnutzung_korr.xlsx_ wird eingelesen und in den Spalten _nutzung_, _geschlecht_
und _altersklasse_ fehlende Werte durch den Vorwert ersetzt

```{r, echo=T}
library(readxl)
path <- "/Users/schmis12/wrk/studio/ZHAW_CAS_Data_Analysis/Leistungsnachweis_A2/data/"
nn <- read_xlsx(paste0(path, "Internetnutzung_korr.xlsx"), range = "A3:F38", na = c("", "()"),
    col_names = c("nutzung", "geschlecht", "altersklasse", "bildungsstand", "x2019", "x2017")
  )

na_to_prev <- function(x) {
  if (length(x) > 0L) {
    non.na.idx <- which(!is.na(x))
    if (is.na(x[1L])) {
      non.na.idx <- c(1L, non.na.idx)
    }
    rep.int(x[non.na.idx], diff(c(non.na.idx, length(x) + 1L)))
  }
}

nn$nutzung <- na_to_prev(nn$nutzung)
nn$geschlecht <- na_to_prev(nn$geschlecht)
nn$altersklasse <- na_to_prev(nn$altersklasse)
head(nn)
```

